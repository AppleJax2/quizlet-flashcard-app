import{r,u as S,j as e,U as E,h as m}from"./index-311eb106.js";import{u as b}from"./index.esm-301e9dda.js";function U({title:s,titleId:a,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":a},n),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0Zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25"}))}const A=r.forwardRef(U),C=A;function I({title:s,titleId:a,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":a},n),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"}))}const F=r.forwardRef(I),$=F;function L({title:s,titleId:a,...n},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":a},n),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const q=r.forwardRef(L),Z=q;function B(){var p;const{user:s,refreshUser:a}=S(),[n,o]=r.useState(!1),[x,h]=r.useState(!1),{register:f,handleSubmit:g,formState:{errors:c},reset:w}=b(),{register:u,handleSubmit:j,formState:{errors:d},reset:y,watch:N}=b(),v=N("newPassword","");r.useEffect(()=>{s&&w({username:s.username||"",email:s.email||""})},[s,w]);const P=async l=>{o(!0);try{const t=await fetch("/api/v1/users/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({username:l.username,email:l.email})}),i=await t.json();if(!t.ok)throw new Error(i.message||"Failed to update profile");i.token&&localStorage.setItem("token",i.token),a&&await a(),m.success("Profile updated successfully")}catch(t){m.error(t instanceof Error?t.message:"An error occurred")}finally{o(!1)}},k=async l=>{h(!0);try{const t=await fetch("/api/v1/users/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({currentPassword:l.currentPassword,newPassword:l.newPassword})}),i=await t.json();if(!t.ok)throw new Error(i.message||"Failed to change password");i.token&&localStorage.setItem("token",i.token),y(),m.success("Password changed successfully")}catch(t){m.error(t instanceof Error?t.message:"An error occurred")}finally{h(!1)}};return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-900",children:"Profile Settings"}),e.jsx("p",{className:"mt-2 text-sm text-neutral-600",children:"Manage your account information and security settings"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsx("aside",{className:"md:col-span-1",children:e.jsxs("div",{className:"border border-neutral-200 rounded-lg overflow-hidden bg-white shadow-sm",children:[e.jsxs("div",{className:"p-6 text-center border-b border-neutral-200 bg-neutral-50",children:[e.jsx("div",{className:"inline-block h-24 w-24 rounded-full bg-gradient-to-br from-primary-500 to-primary-600 mb-4 flex items-center justify-center text-white text-4xl font-bold shadow-inner",children:((p=s==null?void 0:s.username)==null?void 0:p.charAt(0))||"U"}),e.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:(s==null?void 0:s.username)||"User"}),e.jsx("p",{className:"text-sm text-neutral-500",children:(s==null?void 0:s.email)||"user@example.com"})]}),e.jsx("nav",{className:"p-4",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:e.jsxs("button",{className:"flex w-full items-center px-3 py-2 text-sm rounded-md text-neutral-700 bg-primary-50 font-medium","aria-current":"page",children:[e.jsx(E,{className:"mr-3 h-5 w-5 text-primary-500","aria-hidden":"true"}),e.jsx("span",{children:"Profile Information"})]})}),e.jsx("li",{children:e.jsxs("button",{className:"flex w-full items-center px-3 py-2 text-sm rounded-md text-neutral-600 hover:text-neutral-900 hover:bg-neutral-50",children:[e.jsx($,{className:"mr-3 h-5 w-5 text-neutral-400","aria-hidden":"true"}),e.jsx("span",{children:"Account Security"})]})})]})})]})}),e.jsxs("main",{className:"md:col-span-2 space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 bg-neutral-50",children:[e.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"Profile Information"}),e.jsx("p",{className:"mt-1 text-sm text-neutral-500",children:"Update your account information and email address"})]}),e.jsxs("form",{onSubmit:g(P),className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Z,{className:"h-5 w-5 text-neutral-400","aria-hidden":"true"})}),e.jsx("input",{id:"username",type:"text",...f("username",{required:"Username is required",minLength:{value:3,message:"Username must be at least 3 characters"},maxLength:{value:50,message:"Username cannot exceed 50 characters"}}),className:"pl-10 block w-full rounded-md border-neutral-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"})]}),c.username&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.username.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(C,{className:"h-5 w-5 text-neutral-400","aria-hidden":"true"})}),e.jsx("input",{id:"email",type:"email",...f("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),className:"pl-10 block w-full rounded-md border-neutral-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"})]}),c.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.email.message})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:n,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Updating...":"Save Changes"})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-neutral-200 bg-neutral-50",children:[e.jsx("h2",{className:"text-lg font-medium text-neutral-900",children:"Change Password"}),e.jsx("p",{className:"mt-1 text-sm text-neutral-500",children:"Update your password to maintain account security"})]}),e.jsxs("form",{onSubmit:j(k),className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Current Password"}),e.jsx("input",{id:"currentPassword",type:"password",...u("currentPassword",{required:"Current password is required"}),className:"block w-full rounded-md border-neutral-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"}),d.currentPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.currentPassword.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-neutral-700 mb-1",children:"New Password"}),e.jsx("input",{id:"newPassword",type:"password",...u("newPassword",{required:"New password is required",minLength:{value:8,message:"Password must be at least 8 characters"},pattern:{value:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,message:"Password must include uppercase, lowercase, number and special character"}}),className:"block w-full rounded-md border-neutral-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"}),d.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.newPassword.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Confirm New Password"}),e.jsx("input",{id:"confirmPassword",type:"password",...u("confirmPassword",{required:"Please confirm your password",validate:l=>l===v||"Passwords do not match"}),className:"block w-full rounded-md border-neutral-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"}),d.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.confirmPassword.message})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:x,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-secondary-600 hover:bg-secondary-700 focus:outline-none focus:ring-2 focus:ring-secondary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Changing Password...":"Change Password"})})]})]})]})]})]})}export{B as default};
